<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Mini Data-Binding Demo</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; }
    /*ul { list-style: none; padding: 0; }
    li { margin: 0.5rem 0; }*/
    button { margin-top: 1rem; padding: 0.5rem 1rem; }
  </style>

  <script src="reactive.js"></script>
  <script src="template-engine.js"></script>
</head>
<body>

<div id="headline">
    <input id="name" value="{{ name }}">
    <h1 style="background-color: {{ headlineBackground }};">Willkommen, {{ name }}!</h1>
    <p>Hallo {{ name }}</p>

  <!-- IF-Direktive -->
  <if test="showCondTitle">
    <h1 style="background-color: {{ headlineBackground }};">bedingtes Willkommen, {{ name }}!</h1>

    <if test="showCondTitle2">
      <h2>bedingtes Willkommen, {{ name }}!</h2>
    </if>
  </if>
</div>

<div id="main">
  <!-- EACH-Direktive -->
  <ul>
    <each of="items" as="item">
      <if test="item.isYoung">
        <li style="background-color: {{ liBackground }}">{{ item.name }} ({{ item.age }} Jahre)</li>
        <ul>
          <div>TEST</div>
          <each of="item.children" as="child">
              <li onclick="alert('test')">{{ child.name }}</li>
          </each>
        </ul>
      </if>
    </each>
  </ul>

  <p>ABSATZ</p>

  <recursive-template name="rec1" of="items">
    <ul>
      <each of-rec="rec1" as="item">
        <li onclick="alert('test')" style="background-color: {{ liBackground }}">
          {{ item.name }} ({{ item.age }} Jahre)
        
          <recursive-template use="rec1" of="item.children"></recursive-template>
        </li>
      </each>
    </ul>
  </recursive-template>

  <p>ABSATZ</p>

  <recursive-template use="rec1" of="items"></recursive-template>

  <button id="push">Push</button>
  <button id="pop">Pop</button>

  <button id="toggle">Titel umschalten</button>
</div>

<script>

  const headlineModel = reactive({
    showCondTitle: true,
    showCondTitle2: true,
    headlineBackground: 'yellow',
    name: 'Tobias'
  }, () => render(document.getElementById('headline'), headlineModel))

  const mainModel = reactive({
    items: [
      { name: 'Alice', age: 25, children: [ { name: 'Alice_1', age: 10, children: [ { name: 'Alice_1_1', age: 5 } ] } ] },
      { name: 'Bob', age: 30 },
      { name: 'Charlie', age: 20, children: [ { name: 'Charlie_1', age: 5 } ] }
    ],
    liBackground: 'yellow'
  }, () => render(document.getElementById('main'), mainModel))

  mainModel.items.forEach(e => {
    if (e.age <= 25) {
      e.isYoung = true
    }
  });

  // -----------------------------
  // Initiales Rendering
  // -----------------------------
  render(document.getElementById('headline'), headlineModel)
  render(document.getElementById('main'), mainModel)

  // -----------------------------
  // Interaktion
  // -----------------------------

  document.getElementById('toggle').addEventListener('click', () => {
    headlineModel.showCondTitle = !headlineModel.showCondTitle;
  });

  document.getElementById('name').addEventListener('input', e => {
    headlineModel.name = e.target.value;
    console.log(headlineModel.name)
  });


  document.getElementById('push').addEventListener('click', () => {
    mainModel.items.push({'name': 'Tobias', 'age': 30})
  });

  document.getElementById('pop').addEventListener('click', () => {
    mainModel.items.pop()
  });
</script>

</body>
</html>
